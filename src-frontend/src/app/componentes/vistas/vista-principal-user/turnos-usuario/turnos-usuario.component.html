<div class="container-fluid">
  <div class="d-flex justify-content-between align-items-center mb-4 animated-card">
    <h2 class="mb-0">Tus grupos</h2>
    <button class="btn btn-secondary btn-back" (click)="volver()">
      <i class="bi bi-arrow-left-circle"></i> Volver
    </button>
  </div>

  <div *ngIf="endpointsService.gruposDelAlumno$ | async as grupos; else noGruposTemplate">
    <!-- Acordeón para mostrar los grupos con sus turnos -->
    <div class="accordion" id="gruposAccordion">
      <div *ngFor="let grupo of grupos; let i = index" class="card shadow-lg mb-3">
        <div class="card-header bg-gradient-primary text-white d-flex justify-content-between align-items-center">
          <h5 class="mb-0">{{ grupo.nombre }}</h5>
          <button class="btn btn-sm btn-outline-light" (click)="toggleVerTurnos(grupo.id, i)">
            {{ grupo.id === grupoSeleccionadoId ? 'Ocultar Turnos' : 'Ver Turnos' }}
          </button>
        </div>

        <!-- Control de visibilidad con animación -->
        <div *ngIf="grupo.id === grupoSeleccionadoId && expandedGrupoIndex === i" 
             class="card-body" 
             [ngClass]="{ 'open': grupo.id === grupoSeleccionadoId && expandedGrupoIndex === i }">
          <div *ngIf="endpointsService.turnosDelGrupo$ | async as turnos; else noTurnosTemplate">
            <!-- Listado de turnos -->
            <div *ngFor="let diaSemana of diasSemana" class="dia-container mb-4 animated-turnos">
              <h6 class="dia-header p-2 rounded">{{ diaSemana }}</h6>
              <div *ngIf="obtenerTurnosPorDia(turnos, diaSemana).length > 0">
                <ul class="list-group">
                  <li *ngFor="let turno of obtenerTurnosPorDia(turnos, diaSemana)" 
                      class="list-group-item d-flex justify-content-between align-items-center">
                    <span>{{ turno.horaInicio }} - {{ turno.horaFin }}</span>
                  </li>
                </ul>
              </div>
              <div *ngIf="obtenerTurnosPorDia(turnos, diaSemana).length === 0" class="no-turnos p-2 mt-2 text-muted">
                No hay turnos disponibles
              </div>
            </div>
          </div>

          <ng-template #noTurnosTemplate>
            <div class="alert alert-warning text-center mt-4 animated-fade-in" role="alert">
              No se encontraron turnos para este grupo.
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </div>

  <ng-template #noGruposTemplate>
    <div class="alert alert-warning text-center mt-4" role="alert">
      No se encontraron grupos para este alumno.
    </div>
  </ng-template>
</div>
