<div class="container">
  <div class="d-flex justify-content-between align-items-center mb-4 animated-card">
    <h2 class="mb-0">Tus grupos</h2>
    <button class="btn btn-secondary btn-back" (click)="volver()">
      <i class="bi bi-arrow-left-circle"></i> Volver
    </button>
  </div>

  <div *ngIf="endpointsService.gruposDelAlumno$ | async as grupos; else noGruposTemplate">
    <div *ngFor="let grupo of grupos" class="card shadow-lg mb-4 animated-group">
      <div class="card-header text-center bg-gradient-primary text-white">
        <h3 class="card-title">{{ grupo.nombre }}</h3>
      </div>
      <div class="card-body">
        <button class="btn btn-primary" (click)="verTurnos(grupo.id)">
          {{ grupo.id === grupoSeleccionadoId ? 'Ocultar Turnos' : 'Ver Turnos' }}
        </button>

        <div *ngIf="grupo.id === grupoSeleccionadoId" class="animated-turnos">
          <div *ngIf="endpointsService.turnosDelGrupo$ | async as turnos; else noTurnosTemplate">
            <table class="table custom-table table-striped mt-4">
              <thead class="thead-dark">
                <tr>
                  <th class="text-center">DÃ­a de la Semana</th>
                  <th class="text-center">Hora de Inicio</th>
                  <th class="text-center">Hora de Fin</th>
                </tr>
              </thead>
              <tbody>
                <ng-container *ngFor="let diaSemana of diasSemana">
                  <ng-container *ngIf="obtenerTurnosPorDia(turnos, diaSemana).length > 0">
                    <tr *ngFor="let turno of obtenerTurnosPorDia(turnos, diaSemana); let i = index">
                      <td
                        *ngIf="i === 0"
                        [attr.rowspan]="obtenerTurnosPorDia(turnos, diaSemana).length"
                        class="text-center align-middle font-weight-bold"
                      >
                        {{ diaSemana }}
                      </td>
                      <td class="text-center align-middle">{{ turno.horaInicio }}</td>
                      <td class="text-center align-middle">{{ turno.horaFin }}</td>
                    </tr>
                  </ng-container>
                  <tr *ngIf="obtenerTurnosPorDia(turnos, diaSemana).length === 0">
                    <td class="text-center align-middle font-weight-bold">{{ diaSemana }}</td>
                    <td colspan="2" class="text-center align-middle">No hay turnos</td>
                  </tr>
                </ng-container>
              </tbody>
            </table>
          </div>
          <ng-template #noTurnosTemplate>
            <div class="alert alert-warning text-center mt-4 animated-fade-in" role="alert">
              No se encontraron turnos para este grupo.
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </div>

  <ng-template #noGruposTemplate>
    <div class="alert alert-warning text-center mt-4" role="alert">
      No se encontraron grupos para este alumno.
    </div>
  </ng-template>
</div>